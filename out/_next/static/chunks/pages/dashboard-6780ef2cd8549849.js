(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{7100:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(2494)}])},6076:(e,t,a)=>{"use strict";a.d(t,{u:()=>r});var n=a(3110),s=a(4335);class l{getTimestamp(){return Math.floor(Date.now()/1e3).toString()}async generateSignature(e){let t=new TextEncoder,a=t.encode(this.secretKey),n=await crypto.subtle.importKey("raw",a,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return btoa(Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",n,t.encode(e)))).map(e=>String.fromCharCode(e)).join(""))}async request(e){try{return(await this.client.request(e)).data}catch(e){throw console.error("Ошибка API запроса:",e),e}}constructor(e,t){this.addSignatureAndTimestamp=async e=>{let t=JSON.stringify(e.data||e.params||{}),a=this.getTimestamp(),s=await this.generateSignature(t);return e.headers||(e.headers=new n.$t),e.headers.set("Content-Type","application/json"),e.headers.set("X-TIMESTAMP",a),e.headers.set("X-SIGNATURE",s),e},this.secretKey=t,this.client=s.A.create({baseURL:e}),this.client.interceptors.request.use(this.addSignatureAndTimestamp)}}let r=new l("https://api.eralab.net/api","iO0HgZuPjY6OVm9UxpG9hGuhWujuiERL8t5CFvrJB0tWSN18TsWl86eNxZJkFpYMv0mm7tz2MnM6g0v8wQPYTw==")},2494:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var n=a(4848),s=a(6540),l=a(6715),r=a(571),o=a(8032),c=a.n(o),i=a(8322),d=a.n(i);let u=e=>{let{walletData:t,onCopyAddress:a}=e,s=t.walletAddressNonBounce?"".concat(t.walletAddressNonBounce.slice(0,4),"****").concat(t.walletAddressNonBounce.slice(-4)):"N/A";return(0,n.jsxs)("div",{className:d().walletInfo,children:[(0,n.jsxs)("h2",{children:["Username: ",null!==t.username?t.username:"N/A"]}),(0,n.jsxs)("h2",{children:["TON: ",null!==t.balanceTon?t.balanceTon.toFixed(2):"N/A"]}),(0,n.jsx)("p",{className:d().walletAddress,onClick:a,title:"Нажмите для копирования",children:s})]})};var h=a(5867),w=a.n(h);let m=e=>{let{onClick:t}=e;return(0,n.jsx)("div",{className:w().settingsIcon,onClick:t,children:"⚙️"})};var _=a(671),b=a.n(_);let p=e=>{let{label:t,onClick:a}=e;return(0,n.jsx)("button",{className:b().dashboardButton,onClick:a,children:t})};var N=a(6076);let f=async e=>{if(!e)throw Error("Wallet address is required.");return N.u.request({method:"POST",url:"/users/auth/wallet",data:{walletAddress:e}})},x="walletData",g=()=>{let e=localStorage.getItem(x);if(!e)return null;let{data:t,timestamp:a}=JSON.parse(e);return(Date.now()-a)/6e4>60?(localStorage.removeItem(x),null):t},A=e=>{let t={data:e,timestamp:Date.now()};localStorage.setItem(x,JSON.stringify(t))},v=async e=>{try{var t,a,n;let s=g();if(s)return console.log("Данные из кэша:",s),s;let l=await f(e);console.log("Полученные данные кошелька:",l);let r={walletAddress:l.walletAddress,walletAddressNonBounce:l.walletAddressNonBounce,balanceTon:null!==(t=l.balanceTon)&&void 0!==t?t:0,balanceUsd:null!==(a=l.balanceUsd)&&void 0!==a?a:0,eralabPoints:null!==(n=l.eralabPoints)&&void 0!==n?n:0,username:l.username||"Без имени"};return A(r),r}catch(e){throw console.error("Ошибка в сервисе кошелька:",e),e}};var T=a(4131),j=a.n(T);let I=()=>(0,n.jsx)("div",{className:j().container,children:(0,n.jsx)("p",{className:j().text,children:"alpha build v0.0.5"})}),C=()=>{var e;let t=(0,r.c5)(),a=(0,l.useRouter)(),o=(null==t?void 0:null===(e=t.account)||void 0===e?void 0:e.address)||null,[i,d]=(0,s.useState)(null),[h,w]=(0,s.useState)(!0),[_,b]=(0,s.useState)(null);if((0,s.useEffect)(()=>{(async()=>{if(!o){b("Адрес кошелька не найден."),w(!1);return}w(!0),b(null);try{let e=await v(o);d(e)}catch(e){console.error("Ошибка при загрузке данных валлета:",e),b("Ошибка при загрузке данных валлета. Попробуйте позже.")}finally{w(!1)}})()},[o]),(0,s.useEffect)(()=>{let e=setInterval(()=>{o&&v(o).then(e=>{e&&d(t=>t?{...t,balanceTon:e.balanceTon,balanceUsd:e.balanceUsd}:null)}).catch(e=>console.error("Ошибка при обновлении баланса:",e))},3e5);return()=>clearInterval(e)},[o]),h)return(0,n.jsx)("p",{className:c().loadingMessage,children:"Загрузка данных..."});if(_)return(0,n.jsxs)("div",{className:c().errorContainer,children:[(0,n.jsx)("p",{className:c().errorMessage,children:_}),(0,n.jsx)("button",{className:c().retryButton,onClick:()=>{w(!0),b(null)},children:"Повторить"})]});if(!i)return(0,n.jsx)("p",{className:c().errorMessage,children:"Данные валлета недоступны."});let N=e=>{a.push("".concat(e))};return(0,n.jsxs)("div",{className:c().container,children:[(0,n.jsx)(m,{onClick:()=>a.push("/settings")}),(0,n.jsx)("div",{className:c().walletInfoContainer,children:(0,n.jsx)(u,{walletData:{eralabPoints:i.eralabPoints||0,balanceUsd:i.balanceUsd||null,balanceTon:i.balanceTon||null,username:i.username||null,walletAddressNonBounce:i.walletAddressNonBounce},onCopyAddress:()=>{i.walletAddressNonBounce&&navigator.clipboard.writeText(i.walletAddressNonBounce).then(()=>alert("Адрес скопирован!")).catch(()=>alert("Ошибка при копировании адреса."))}})}),(0,n.jsxs)("div",{className:c().buttonContainer,children:[(0,n.jsx)(p,{label:"MARKET",onClick:()=>N("/collections")}),(0,n.jsx)(p,{label:"DAO",onClick:()=>N("/dao")})]}),(0,n.jsx)(I,{})]})}},671:e=>{e.exports={dashboardButton:"DashboardButton_dashboardButton__6Ghgp"}},5867:e=>{e.exports={settingsIcon:"SettingsIcon_settingsIcon__NYsNt"}},4131:e=>{e.exports={container:"VersionInfo_container__kzZDH",text:"VersionInfo_text__1dp3P"}},8322:e=>{e.exports={walletInfo:"WalletInfo_walletInfo__F1_Nf",eralabInfo:"WalletInfo_eralabInfo__mPliK",walletAddress:"WalletInfo_walletAddress__ccW_l"}},8032:e=>{e.exports={container:"Dashboard_container__KcHrK",buttonContainer:"Dashboard_buttonContainer__zXYA_",walletInfoContainer:"Dashboard_walletInfoContainer__htTA3"}}},e=>{var t=t=>e(e.s=t);e.O(0,[556,636,593,792],()=>t(7100)),_N_E=e.O()}]);