(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[947],{2126:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/nfts",function(){return n(6457)}])},6457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var o=n(4848),r=n(6540),a=n(6715),s=n(804),l=n.n(s),i=n(9965),c=n.n(i),d=n(4335);async function u(e,t){let n=new TextEncoder,o=await crypto.subtle.importKey("raw",n.encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.sign("HMAC",o,n.encode(e)))))}async function N(e,t,n){try{console.log("Запрос данных NFT:",{userAccountId:e,collectionAddress:t,page:n});let o=JSON.stringify({userAccountId:e,collectionAddress:t,page:n}),r=Math.floor(Date.now()/1e3).toString(),a=await u(o,"iO0HgZuPjY6OVm9UxpG9hGuhWujuiERL8t5CFvrJB0tWSN18TsWl86eNxZJkFpYMv0mm7tz2MnM6g0v8wQPYTw=="),s=await d.A.get("".concat("https://api.eralab.net/api","/nfts/filtered-user-collection-nfts"),{params:{accountId:e,collectionAddress:t,page:n},headers:{"Content-Type":"application/json","X-TIMESTAMP":r,"X-SIGNATURE":a}});return console.log("Ответ API:",s.data),s.data.map(e=>({nftAddress:e.nftAddress,name:e.name,imageUrl:e.imageUrl,description:e.description,collectionAddress:e.collectionAddress,attributes:e.attributes}))}catch(e){throw console.error("Ошибка при загрузке NFT:",e),Error("Не удалось загрузить данные NFT.")}}let h=e=>e.startsWith("ipfs://")?e.replace("ipfs://","https://ipfs.io/ipfs/"):e,_=()=>{let e=(0,a.useRouter)(),{collectionName:t,collectionAddress:n}=e.query,[s,i]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[_,p]=(0,r.useState)(null),[m,g]=(0,r.useState)(1),[T,f]=(0,r.useState)(!1),w=e.query.userAccountId;(0,r.useEffect)(()=>{(async()=>{if(n&&w)try{console.log("Начинаем загрузку данных. Коллекция:",n,"Пользователь:",w,"Страница:",m);let e=await N(w,n,m);console.log("Полученные NFT:",e),i(e),u(!1)}catch(e){console.error("Ошибка при загрузке NFT:",e),p("Ошибка при загрузке NFT."),u(!1)}else w||(console.error("Адрес кошелька не передан."),p("Адрес кошелька не передан."))})()},[n,w,m]);let F=async()=>{f(!0);try{let e=m+1;console.log("Загружаем следующую страницу:",e);let t=await N(w,n,e);console.log("Новые NFT:",t),i(e=>[...e,...t]),g(e)}catch(e){console.error("Ошибка при загрузке дополнительных NFT:",e),alert("Не удалось загрузить дополнительные NFT.")}finally{f(!1)}};return(0,o.jsxs)("div",{className:l().container,children:[(0,o.jsx)("h1",{className:l().title,children:t}),d?(0,o.jsx)("p",{children:"Загрузка..."}):_?(0,o.jsx)("p",{className:l().error,children:_}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:l().grid,children:0===s.length?(0,o.jsx)("p",{children:"Нет доступных NFT для отображения."}):s.map(e=>(0,o.jsxs)("div",{className:l().card,children:[e.imageUrl?(0,o.jsx)(c(),{src:h(e.imageUrl),alt:e.name||"NFT",width:150,height:150}):(0,o.jsx)("div",{className:l().noImage,children:"Нет изображения"}),(0,o.jsx)("p",{children:e.name||"Без названия"})]},e.nftAddress))}),(0,o.jsx)("div",{className:l().loadMoreContainer,children:(0,o.jsx)("button",{className:l().loadMoreButton,onClick:F,disabled:T,children:T?"Загрузка...":"Загрузить еще"})})]})]})}},804:e=>{e.exports={container:"NFTCollection_container__Kxfwl",title:"NFTCollection_title__9Xkg8",grid:"NFTCollection_grid__NNf8p",card:"NFTCollection_card__byzzq",loadMoreContainer:"NFTCollection_loadMoreContainer__vHc0g",noImage:"NFTCollection_noImage__sK_8B",loadMoreButton:"NFTCollection_loadMoreButton__mpzAb"}}},e=>{var t=t=>e(e.s=t);e.O(0,[909,965,636,593,792],()=>t(2126)),_N_E=e.O()}]);