(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{7100:(e,a,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return n(1571)}])},1571:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>b});var s=n(4848),r=n(6540),t=n(6715),o=n(4335);async function l(e){try{return await e}catch(e){throw console.error("API Error:",e),e}}async function c(e,a){let n=new TextEncoder,s=await crypto.subtle.importKey("raw",n.encode(a),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.sign("HMAC",s,n.encode(e)))))}async function d(e){var a,n,s;if(!e)throw Error("Wallet address is required.");let r=JSON.stringify({walletAddress:e}),t=Math.floor(Date.now()/1e3).toString(),d=await c(r,"iO0HgZuPjY6OVm9UxpG9hGuhWujuiERL8t5CFvrJB0tWSN18TsWl86eNxZJkFpYMv0mm7tz2MnM6g0v8wQPYTw=="),i=await l(o.A.post("".concat("https://api.eralab.net/api","/users/auth/wallet"),{walletAddress:e},{headers:{"Content-Type":"application/json","X-TIMESTAMP":t,"X-SIGNATURE":d}}));if(!i.data)throw console.warn("Ответ от сервера пуст."),Error("Empty server response");let u=i.data;return console.log("API Response:",u),{walletAddress:u.walletAddress,walletAddressNonBounce:u.walletAddressNonBounce,balanceTon:null!==(a=u.balanceTon)&&void 0!==a?a:0,balanceUsd:null!==(n=u.balanceUsd)&&void 0!==n?n:0,eralabPoints:null!==(s=u.eralabPoints)&&void 0!==s?s:0,username:u.username}}var i=n(571),u=n(8032),h=n.n(u);let b=()=>{var e;let a=(0,i.c5)(),n=(0,t.useRouter)(),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),_=(0,r.useCallback)(async()=>{if(!b&&!o){if(w(!0),u(!1),!a||!a.account){n.push("/");return}try{let e=await d(a.account.address);console.log("Данные кошелька:",e),l(e)}catch(e){console.error("Ошибка при загрузке данных о кошельке:",e),u(!0)}finally{w(!1)}}},[b,a,o,n]);if((0,r.useEffect)(()=>{o||_()},[_,o]),c)return(0,s.jsxs)("div",{className:h().errorContainer,children:[(0,s.jsx)("p",{className:h().errorMessage,children:"Не удалось загрузить данные. Попробуйте снова."}),(0,s.jsx)("button",{className:h().retryButton,onClick:_,children:"Повторить"})]});if(b)return(0,s.jsx)("p",{className:h().loadingMessage,children:"Загрузка..."});if(!o)return(0,s.jsx)("p",{className:h().errorMessage,children:"Данные кошелька недоступны."});let N=(null==o?void 0:o.walletAddressNonBounce)?"".concat(o.walletAddressNonBounce.slice(0,4),"****").concat(o.walletAddressNonBounce.slice(-4)):"N/A",A=e=>{n.push("".concat(e,"?userAccountId=").concat(encodeURIComponent(o.walletAddress)))};return(0,s.jsxs)("div",{className:h().container,children:[(0,s.jsx)("div",{className:h().settingsIcon,onClick:()=>{n.push("/settings")},children:"⚙️"}),(0,s.jsxs)("h2",{className:h().eralabInfo,children:["ERALAB: ",o.eralabPoints]}),(0,s.jsxs)("h2",{className:h().eralabInfo,children:["USD: ",null===(e=o.balanceUsd)||void 0===e?void 0:e.toFixed(2)]}),(0,s.jsxs)("h2",{children:["TON: ",null!==o.balanceTon?o.balanceTon.toFixed(2):"N/A"]}),(0,s.jsxs)("h2",{children:["Username: ",null!==o.username?o.username:"N/A"]}),(0,s.jsx)("p",{className:h().walletAddress,onClick:()=>{(null==o?void 0:o.walletAddressNonBounce)&&(navigator.clipboard.writeText(o.walletAddressNonBounce),alert("Адрес скопирован!"))},title:"Нажмите для копирования",children:N}),(0,s.jsxs)("div",{className:h().iconContainer,children:[(0,s.jsx)("button",{className:"".concat(h().dashboardButton," button"),onClick:()=>A("/collection"),children:"MARKET"}),(0,s.jsx)("button",{className:"".concat(h().dashboardButton," button"),onClick:()=>A("/dao"),children:"DAO"})]})]})}},8032:e=>{e.exports={container:"Dashboard_container__KcHrK",iconContainer:"Dashboard_iconContainer__tIMCF",dashboardButton:"Dashboard_dashboardButton__65AnI",settingsIcon:"Dashboard_settingsIcon__D5WK_",walletAddress:"Dashboard_walletAddress__2fBtd",errorMessage:"Dashboard_errorMessage__zFgb8",loadingMessage:"Dashboard_loadingMessage__IRFPA"}}},e=>{var a=a=>e(e.s=a);e.O(0,[909,636,593,792],()=>a(7100)),_N_E=e.O()}]);